
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.0, mkdocs-material-8.5.6">
    
    
      
        <title>Docs for glazy</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#install" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Docs for glazy" class="md-header__button md-logo" aria-label="Docs for glazy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Docs for glazy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Homepage
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Docs for glazy" class="md-nav__button md-logo" aria-label="Docs for glazy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Docs for glazy
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Homepage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        Homepage
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-use" class="md-nav__link">
    How To Use
  </a>
  
    <nav class="md-nav" aria-label="How To Use">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-its-used-for" class="md-nav__link">
    What It's Used For
  </a>
  
    <nav class="md-nav" aria-label="What It's Used For">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-use-cases" class="md-nav__link">
    Example Use Cases
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quick-start-example-code" class="md-nav__link">
    Quick Start Example Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-use-cases" class="md-nav__link">
    Advanced Use Cases
  </a>
  
    <nav class="md-nav" aria-label="Advanced Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resource-dataclasses" class="md-nav__link">
    Resource + Dataclasses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-safety" class="md-nav__link">
    Thread Safety
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#active-resource-proxy" class="md-nav__link">
    Active Resource Proxy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-testing" class="md-nav__link">
    Unit Testing
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="api/glazy/" target="_blank" class="md-nav__link">
        API reference
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-use" class="md-nav__link">
    How To Use
  </a>
  
    <nav class="md-nav" aria-label="How To Use">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-its-used-for" class="md-nav__link">
    What It's Used For
  </a>
  
    <nav class="md-nav" aria-label="What It's Used For">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-use-cases" class="md-nav__link">
    Example Use Cases
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quick-start-example-code" class="md-nav__link">
    Quick Start Example Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-use-cases" class="md-nav__link">
    Advanced Use Cases
  </a>
  
    <nav class="md-nav" aria-label="Advanced Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resource-dataclasses" class="md-nav__link">
    Resource + Dataclasses
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-safety" class="md-nav__link">
    Thread Safety
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#active-resource-proxy" class="md-nav__link">
    Active Resource Proxy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-testing" class="md-nav__link">
    Unit Testing
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="install">Install<a class="headerlink" href="#install" title="Permanent link">&para;</a></h1>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># via pip</span>
pip install glazy

<span class="c1"># via poetry</span>
poetry add glazy
</code></pre></div></td></tr></table></div>
<h2 id="how-to-use">How To Use<a class="headerlink" href="#how-to-use" title="Permanent link">&para;</a></h2>
<p>The main class used most of the time is <code>glazy.resource.Resource</code>.
Read the below/this-document first, but after your done here and need more details see
<code>glazy.resource.Resource</code>, you can look at the doc-comment for that module and class for
more detailed  reference-type documentation.</p>
<p>Below is a high-level-overview of how to use this library</p>
<h3 id="what-its-used-for">What It's Used For<a class="headerlink" href="#what-its-used-for" title="Permanent link">&para;</a></h3>
<p>If you need a lazily created singleton-type object
(but can still temporary override in a decoupled fashion if needed)
then this library could come in use for your situation.</p>
<h4 id="example-use-cases">Example Use Cases<a class="headerlink" href="#example-use-cases" title="Permanent link">&para;</a></h4>
<ul>
<li>Network connection and/or a remote resource/client.</li>
<li>You can wrap these objects in a <code>resource</code>, the resource provides the object.</li>
<li>Objects to wrap are 'client' like things, and allow you to communicate with some external system.</li>
<li>Very common for these objects to represent an already-open network connection,
    So there are performance considerations to try and keep connection open and to reuse it.</li>
<li>See <code>xyn_aws</code> for a special Resource subclass that wraps boto clients/resources,
    allows you to lazily get a shared aws client/resource.<ul>
<li>It also uses a more advance feature, ActiveResourceProxy, to represent boto resources/clients
  that are importable into other modules and directly usable.</li>
</ul>
</li>
<li>Common configuration or setting values</li>
<li>See also:<ul>
<li>xyn_settings</li>
<li>A Resource subclass that has extra features geared towards this use case.</li>
<li>xyn_config</li>
<li>Way to get settings from SSM, Secrets Manager and other remote locations.</li>
</ul>
</li>
<li>Anything that needs to be lazily allocated,
  especially if they need to be re-created for each unit-test run.</li>
<li>Example: things with moto, requests-mock<ul>
<li>This use useful when session/clients needs to be created after a mock installed.
  So if code-base uses Resource  to grab a requests session (for example),
  when a new unit-test runs it will allocate a new requests session, and mock will therefore work.
  While at the same time the code in prod/deployed code it will just use a shared session
  that sticks around  between lambda runs, etc. (which is what you want to happen in deployed code).</li>
</ul>
</li>
<li>Basic dependency injection scenarios, where two separate pieces of code need to use a shared
  object of some sort that you want to 'inject' into them.</li>
<li>Does it in a way that prevents you having to pass around the object manually everywhere.</li>
<li>Promotes code-decoupling, since there is less-temptation to couple them if it's easy to share
    what they need between each-other, without having each piece of code having to know about each-other.</li>
</ul>
<h3 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h3>
<p>The main class used most of the time is <code>glazy.resource.Resource</code>,
you can look at the doc-comment for that module and class for more details.</p>
<p>Allows you to create sub-classes that act as sharable singleton-type objects that
we are calling resources here.
These are also typically objects that should generally stick around and should be created lazily.</p>
<p>Also allows code to temporarily create, customize and activate a resource if you don't want
the customization to stick around permanently.
You can do it without your or other code needing to be aware of each other.</p>
<p>This helps promote code decoupling, since it's so easy to make a Resource activate it
as the 'current' version to use.</p>
<p>The only coupling that takes place is to the Resource sub-class it's self.</p>
<p>Each separate piece of code can be completely unaware of each other,
and yet each one can take advantage of the shared resource.</p>
<p>This means that Resource can also help with simple dependency injection use-case scenarios.</p>
<h3 id="quick-start-example-code">Quick Start Example Code<a class="headerlink" href="#quick-start-example-code" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">glazy</span> <span class="kn">import</span> <span class="n">Resource</span>

<span class="c1"># This is a example Resource class, the intent with this class is to treat </span>
<span class="c1"># it as a semi-singleton shared resource.</span>
<span class="k">class</span> <span class="nc">MyResource</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>

    <span class="c1"># It&#39;s important to allow resources to be allocated with</span>
    <span class="c1"># no required init arguments.</span>
    <span class="c1"># That way a default-instance/version of the class can</span>
    <span class="c1"># easily be created lazily.</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;my-default-value&#39;</span>

<span class="c1"># Gets currently active instance of `MyResource`, or lazily creates if needed.</span>
<span class="c1"># If system creates a new instance of MyResource, it will save it and reuse it</span>
<span class="c1"># in the future when it&#39;s asked for.</span>
<span class="c1">#</span>
<span class="c1"># Next, we get value of `some_attribute` off of it.</span>
<span class="c1"># Prints &#39;my-default-value&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MyResource</span><span class="o">.</span><span class="n">resource</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># Change the value of the name attribute on current resource</span>
<span class="n">MyResource</span><span class="o">.</span><span class="n">resource</span><span class="p">()</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;changing-the-value&#39;</span>

<span class="c1"># Now prints &#39;changing-the-value&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MyResource</span><span class="o">.</span><span class="n">resource</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># You can temporarily override a resource via a python context manager:</span>
<span class="k">with</span> <span class="n">MyResource</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my-temporary-name&#39;</span><span class="p">):</span>
    <span class="c1"># When someone askes for the current resource of `MyResource`,</span>
    <span class="c1"># they will get back the one I created in `with` statement above.</span>
    <span class="c1">#</span>
    <span class="c1"># Now prints &#39;my-temporary-name&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">MyResource</span><span class="o">.</span><span class="n">resource</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># Object we created and temporary activated by above `with` statement</span>
<span class="c1"># has been deactivated (ie: thrown out).</span>
<span class="c1"># Old one that was the active one previously is the one that is now used when</span>
<span class="c1"># the current resource for `MyResource` is asked for.</span>
<span class="c1">#</span>
<span class="c1"># prints &#39;changing-the-value&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MyResource</span><span class="o">.</span><span class="n">resource</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="advanced-use-cases">Advanced Use Cases<a class="headerlink" href="#advanced-use-cases" title="Permanent link">&para;</a></h2>
<h3 id="resource-dataclasses">Resource + Dataclasses<a class="headerlink" href="#resource-dataclasses" title="Permanent link">&para;</a></h3>
<p>You can use the built-in dataclasses with Resource without a problem.
Just ensure all fields are optional (ie: they all have default values).</p>
<p>Example:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">glazy</span> <span class="kn">import</span> <span class="n">Resource</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span>  <span class="n">dataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">DataResource</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
    <span class="c1"># Making all fields optional, so DataResource can be created lazily:</span>
    <span class="n">my_optional_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">another_optional_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hello!&quot;</span>

<span class="c1"># Get current DataResource resource, print it&#39;s another_optional_field;</span>
<span class="c1"># will print out `hello!`:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DataResource</span><span class="o">.</span><span class="n">resource</span><span class="p">()</span><span class="o">.</span><span class="n">another_optional_field</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="thread-safety">Thread Safety<a class="headerlink" href="#thread-safety" title="Permanent link">&para;</a></h3>
<p>There is a concept of an app-root, and thread-root contexts.</p>
<p>By default, each Resource subclass will be shared between different threads,
ie: it's assumed to be thread-safe.</p>
<p>You can indicate a Resource subclass should not be shared between threads
by inheriting from <code>glazy.resource.ThreadUnsafeResource</code> instead,
or by setting the <strong>class attribute</strong> (on your custom sub-class of Resource)
<code>glazy.resource.Resource.resource_thread_sharable</code> to <code>False</code>.</p>
<p>Things that are probably not thread-safe in general
are resources that contain network/remote type connections/sessions/clients.</p>
<p>Concrete Examples In Code Base:</p>
<ul>
<li>Requests library session</li>
<li>xyn_model_rest uses a Resource to wrap requests library session, so it can automatically
    reuse connections on same thread, but use new session if on different thread.
    Also helps with unit testing, when Mocking requests URL calls.</li>
<li>boto client/resource</li>
<li>Library says it's not thread-safe, you need to use a diffrent object per-thread.</li>
<li>Moto mocking library for AWS services needs you to allocate a client after it's setup,
    (so lazily allocate client/resource from boto).</li>
<li>Use <code>xyn_aws</code> for easy to use Resource's that wrap boto client/resources that
    accomplish being both lazy and will allocate a new one per-thread for you automatically.</li>
</ul>
<h3 id="active-resource-proxy">Active Resource Proxy<a class="headerlink" href="#active-resource-proxy" title="Permanent link">&para;</a></h3>
<p>You can use the convenience method <code>glazy.resource.Resource.resource_proxy</code> to easily get a
proxy object.</p>
<p>Or you can use <code>glazy.proxy.ActiveResourceProxy.wrap</code> to create an object that will act
like the current resource.
All non-dunder attributes/methods will be grabbed/set on the current object instead of the proxy.</p>
<p>This means you can call all non-special methods and access normal attributes,
as if the object was really the currently active resource instance.</p>
<p>Any methods/attributes that start with a <code>_</code> will not be used on the proxied object,
but will be used on only the proxy-object it's self.
This means, you should not ask/set any attributes that start with <code>_</code> (underscore)
when using the proxy object.</p>
<p>A real-world example is <code>xyn_config.config.config</code>, it uses this code for that object:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">glazy</span> <span class="kn">import</span> <span class="n">ActiveResourceProxy</span>
<span class="kn">from</span> <span class="nn">xyn_config</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="c1"># The `xny_resource.proxy.ActiveResourceProxy.wrap` method to get a correctly type-hinted (for IDE)</span>
<span class="c1"># proxy back:</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">ActiveResourceProxy</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">Config</span><span class="p">)</span>

<span class="c1"># This is a simpler way to get the same proxy</span>
<span class="c1"># (no imports are needed, just call the class method on any resource class):</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">resource_proxy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>Now someone can import and use it as-if it's the current config object:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">xyn_config</span> <span class="kn">import</span> <span class="n">config</span>

<span class="n">value</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;some_config_var&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>When you ask <code>config</code> for it's <code>get</code> attribute, it will get it from the current
active resource for <code>Config</code>. So it's the equivalent of doing this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">xyn_config</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="n">get_method</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">resource</span><span class="p">()</span><span class="o">.</span><span class="n">get</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">get_method</span><span class="p">(</span><span class="s1">&#39;some_config_var&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>The code then executes the method that was attached to the <code>get</code> attribute.
This makes the call-stack clean, if an error happens it won't be going through
the ActiveResourceProxy.
The <code>glazy.proxy.ActiveResourceProxy</code> already return the <code>get</code> method  and is finished.
The outer-code is the one that executed/called the method.</p>
<p>Another read-world example is in the <code>xyn_aws</code>.</p>
<p>See <code>glazy.proxy.ActiveResourceProxy</code> for more ref-doc type details.</p>
<h2 id="unit-testing">Unit Testing<a class="headerlink" href="#unit-testing" title="Permanent link">&para;</a></h2>
<p>The <code>glazys.pytest_plugin.xyn_context</code> fixture in particular will be automatically used 
for every unit test. This is important, it ensures a blank root-context is used each time
a unit test executes.</p>
<p>This is accomplished via an <code>autouse=True</code> fixture.
The fixture is in a pytest plugin module.
This plugin module is automatically found and loaded by pytest.
pytest checks all installed dependencies in the environment it runs in,
so as long as glazy is installed in the environment as a dependency it will find this
and autoload this fixture for each unit test.</p>
<p>This means for each unit test executed via pytest, it will always start with no resources
from a previous unit-test execution.</p>
<p>Each unit-test will therefore always start out in the same state,
and a unit-test won't leak/let-slip any of the changes it makes to its
Resources into another unit-test.</p>
<p>This use useful when session/clients needs to be created after a mock installed.
So if code-base uses Resource  to grab a requests session (for example),
when a new unit-test runs it will allocate a new requests session, and mock will therefore work.
While at the same time the code in prod/deployed code it will just use a shared session
that sticks around  between lambda runs, etc. (which is what you want to happen in deployed code).</p>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
      
        
        <a href="changelog/" class="md-footer__link md-footer__link--next" aria-label="Next: Changelog" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Changelog
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.sections", "navigation.expand", "navigation.top", "navigation.indexes", "navigation.tracking", "content.code.annotate"], "search": "assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>